<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
  <title>딜리래빗 반송장 검색</title>
  <style>
    /* 기존 스타일 그대로 반영 (생략 없이 그대로 복사) */
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Noto Sans KR',-apple-system,BlinkMacSystemFont,'Apple SD Gothic Neo','Malgun Gothic',sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;display:flex;flex-direction:column}
    .container{flex:1;display:flex;flex-direction:column;padding:20px;width:100%}
    .header{text-align:center;color:white;margin-bottom:30px;padding-top:20px}
    .header h1{font-size:32px;font-weight:800;margin-bottom:10px}
    .header p{font-size:17px;font-weight:600;opacity:.95}
    .search-box{background:white;border-radius:16px;padding:26px;box-shadow:0 10px 40px rgba(0,0,0,.1);margin-bottom:20px}
    .input-group{display:flex;gap:12px}
    #phoneInput{flex:1;padding:18px 16px;border:2px solid #e0e0e0;border-radius:12px;font-size:18px;font-weight:600;transition:all .3s}
    #phoneInput:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px rgba(102,126,234,.1)}
    #searchButton{padding:18px 32px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;border:none;border-radius:12px;font-size:18px;font-weight:700;cursor:pointer;transition:transform .2s;white-space:nowrap}
    #searchButton:hover{transform:translateY(-2px)}
    #searchButton:active{transform:translateY(0)}
    #searchButton:disabled{background:#ccc;cursor:not-allowed;transform:none}
    .results-container{flex:1;background:white;border-radius:16px;padding:24px;box-shadow:0 10px 40px rgba(0,0,0,.1);overflow-y:auto}
    .result-item{background:#f8f9ff;border-left:5px solid #667eea;padding:24px;margin-bottom:16px;border-radius:12px;transition:transform .2s}
    .result-item:hover{transform:translateX(4px);box-shadow:0 4px 12px rgba(102,126,234,.15)}
    .result-item:last-child{margin-bottom:0}
    .result-numbers{background:white;padding:18px;border-radius:10px;font-size:18px;line-height:2;word-break:break-all}
    .result-numbers div{display:flex;flex-wrap:wrap;align-items:center;gap:10px}
    .result-numbers strong{color:#667eea;min-width:90px;font-weight:800;font-size:19px}
    .number-value{flex:1;color:#1a1a1a;font-family:'Courier New','Consolas',monospace;font-weight:700;font-size:17px;letter-spacing:.3px}
    .divider{color:#667eea;margin:0 6px;font-weight:800;font-size:20px}
    .no-results{text-align:center;padding:60px 20px;color:#666}
    .no-results-icon{font-size:72px;margin-bottom:20px}
    .no-results p{font-size:18px;font-weight:600;line-height:1.6;color:#555}
    .loading{text-align:center;padding:50px;color:#667eea;font-size:19px;font-weight:700}
    .error{background:#fff3f3;border-left:5px solid #ff4444;color:#cc0000;padding:20px;border-radius:10px;margin-top:10px;font-size:17px;font-weight:600}
    @media (max-width:480px){
      .container{padding:16px}
      .header h1{font-size:28px}
      .header p{font-size:16px}
      .search-box{padding:22px}
      .input-group{flex-direction:column}
      #phoneInput{font-size:17px;padding:16px}
      #searchButton{width:100%;font-size:17px}
      .result-item{padding:20px}
      .result-numbers{padding:16px;font-size:17px}
      .result-numbers strong{font-size:18px;min-width:auto}
      .number-value{font-size:16px;font-weight:700}
      .result-numbers div{flex-direction:column;align-items:flex-start;gap:8px}
      .divider{display:none}
      .number-value{width:100%}
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>🐰 딜리래빗 반송장 검색</h1>
      <p>연락처를 입력하여 반송장번호를 조회하세요</p>
    </div>

    <div class="search-box">
      <div class="input-group">
        <input type="tel" id="phoneInput" placeholder="연락처 입력 (예: 010-1234-5678)" autocomplete="tel" />
        <button id="searchButton" onclick="searchTracking()">검색</button>
      </div>
    </div>

    <div class="results-container" id="results">
      <div class="no-results">
        <div class="no-results-icon">📦</div>
        <p>연락처를 입력하고<br />검색 버튼을 눌러주세요</p>
      </div>
    </div>
  </div>

  <script>
    // ① Apps Script Web App로 배포한 API URL 입력
    // 예: https://script.google.com/macros/s/AKfycbx.../exec
    const ENDPOINT_URL = 'https://script.google.com/macros/s/AKfycbxo4BjOc7Cd9hnmfMDDU49aipux7k1Z2QN97NLYOyecHEjh9vBX_WzuMobMUNW6s-s8QA/exec';

    // Enter키 검색
    document.getElementById('phoneInput').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') searchTracking();
    });

    function normalizePhone(v) {
      return (v || '').replace(/[^0-9]/g, '');
    }

    async function searchTracking() {
      const phoneNumber = document.getElementById('phoneInput').value.trim();
      const resultsDiv = document.getElementById('results');
      const searchButton = document.getElementById('searchButton');

      if (!phoneNumber) {
        resultsDiv.innerHTML = '<div class="error">연락처를 입력해주세요.</div>';
        return;
      }

      resultsDiv.innerHTML = '<div class="loading">🔍 검색 중...</div>';
      searchButton.disabled = true;

      try {
        const url = `${ENDPOINT_URL}?phone=${encodeURIComponent(normalizePhone(phoneNumber))}`;
        const res = await fetch(url, { method: 'GET', mode: 'cors', cache: 'no-store' });
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const results = await res.json();
        displayResults(results);
      } catch (err) {
        resultsDiv.innerHTML = `
          <div class="error">
            <strong>오류 발생</strong><br>
            ${err.message || '검색 중 오류가 발생했습니다.'}
          </div>
        `;
      } finally {
        searchButton.disabled = false;
      }
    }

    function displayResults(results) {
      const resultsDiv = document.getElementById('results');

      if (!results || results.length === 0) {
        resultsDiv.innerHTML = `
          <div class="no-results">
            <div class="no-results-icon">😕</div>
            <p>검색 결과가 없습니다.<br>연락처를 다시 확인해주세요.</p>
          </div>
        `;
        return;
      }

      let html = '';
      results.forEach((r) => {
        const trackingNumber = r.trackingNumber || '-';
        const identificationNumber = r.identificationNumber || '-';
        html += `
          <div class="result-item">
            <div class="result-numbers">
              <div>
                <strong>송장번호</strong>
                <span class="number-value">${trackingNumber}</span>
                <span class="divider">|</span>
                <span class="number-value">${identificationNumber}</span>
              </div>
            </div>
          </div>
        `;
      });
      resultsDiv.innerHTML = html;
    }
  </script>
</body>
</html>
